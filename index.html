<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Power Rankings</title>
  <style>
    body { font-family: sans-serif; margin: 24px; }
    h2 { margin-bottom: 12px; }
    .status { margin-bottom: 16px; font-size: 14px; color: #444; }
    .error { color: #b00020; font-weight: bold; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #f0f0f0; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>

<h2>Power Rankings</h2>
<div id="status" class="status">Loadingâ€¦</div>

<table>
  <thead id="table-head"></thead>
  <tbody id="table-body"></tbody>
</table>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQpDJeg-LYWFSe_16a_z6qSkOrcu-X9-pN7PxrtUGtST8LdeJof0cDucvNoFtjZPa1eFFZYLZWWiUHV/pub?output=csv";

function renderTable(data) {
  const [headerRow, ...dataRows] = data;
  const thead = document.getElementById("table-head");
  const tbody = document.getElementById("table-body");

  thead.innerHTML = "<tr>" + headerRow.map(h => `<th>${h}</th>`).join("") + "</tr>";
  tbody.innerHTML = dataRows.map(row =>
    "<tr>" + row.map(cell => `<td>${cell}</td>`).join("") + "</tr>"
  ).join("");
}

(async function main() {
  const statusEl = document.getElementById("status");
  try {
    const res = await fetch(CSV_URL);
    if (!res.ok) throw new Error("Failed to fetch CSV");
    const csvText = await res.text();
    const parsed = Papa.parse(csvText.trim(), { skipEmptyLines: true });
    if (!parsed.data || parsed.data.length < 2) throw new Error("No data found");
    renderTable(parsed.data);
    statusEl.textContent = `Loaded ${parsed.data.length - 1} players.`;
  } catch (err) {
    console.error(err);
    statusEl.innerHTML = '<span class="error">Failed to load CSV. Check the link or console for details.</span>';
  }
})();
</script>

<!-- Modal Container -->
<div class="player-modal" id="modal-MatasVokietaitas" style="display:none;">
  <div class="modal-content">
    <!-- Header -->
    <div class="modal-header">
      <h2 id="modal-name">Player Name</h2>
      <span id="modal-tier" class="tier-label">Tier â€¢ Composite Score</span>
      <button class="close-modal" onclick="closeModal()">Ã—</button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <!-- Snapshot (Always visible) -->
      <section class="module snapshot">
        <h3>ğŸ§¾ Snapshot</h3>
        <p id="modal-snapshot"></p>
      </section>

      <!-- Defensive Versatility -->
      <section class="module defensive free-only">
        <h3>ğŸ›¡ï¸ Defensive Versatility</h3>
        <p id="modal-defensive"></p>
      </section>

      <!-- Shot Quality -->
      <section class="module shot-quality pro-only">
        <h3>ğŸ¯ Shot Quality Model</h3>
        <p id="modal-shotquality"></p>
      </section>

      <!-- Cognitive Profile -->
      <section class="module cognitive elite-only">
        <h3>ğŸ§  Cognitive Profile</h3>
        <p id="modal-cognitive"></p>
      </section>

      <!-- Developmental Archetype -->
      <section class="module archetype elite-only">
        <h3>ğŸ”§ Developmental Archetype</h3>
        <p id="modal-archetype"></p>
      </section>

      <!-- Fit Matrix -->
      <section class="module fit pro-only">
        <h3>ğŸ§© Fit Matrix</h3>
        <p id="modal-fit"></p>
      </section>

      <!-- Possession Tagging -->
      <section class="module possession elite-only">
        <h3>ğŸ” Possession Tagging</h3>
        <p id="modal-possession"></p>
      </section>

      <!-- Historical Echoes -->
      <section class="module echoes elite-only">
        <h3>ğŸª„ Historical Echoes & Comparison</h3>
        <p id="modal-echoes"></p>
      </section>

      <!-- Archetype Drift -->
      <section class="module drift elite-only">
        <h3>ğŸ“ˆ Archetype Drift</h3>
        <p id="modal-drift"></p>
      </section>

      <!-- Spatial IQ -->
      <section class="module spatial pro-only">
        <h3>ğŸ§­ Spatial IQ & Movement</h3>
        <p id="modal-spatial"></p>
      </section>

      <!-- Filtered Metrics -->
      <section class="module metrics elite-only">
        <h3>ğŸ“Š Filtered Metrics & Analytics</h3>
        <p id="modal-metrics"></p>
      </section>

      <!-- Diagnostic Overlay -->
      <section class="module diagnostic elite-only">
        <h3>ğŸ”¬ Diagnostic Overlay</h3>
        <p id="modal-diagnostic"></p>
      </section>

      <!-- Maturity Index -->
      <section class="module maturity pro-only">
        <h3>ğŸ§­ Maturity Index & Intangibles</h3>
        <p id="modal-maturity"></p>
      </section>

      <!-- Composite Tier Label -->
      <section class="module label free-only">
        <h3>ğŸ¯ Composite Tier Label & Placement</h3>
        <p id="modal-label"></p>
      </section>

      <!-- Audit Notes -->
      <section class="module audit elite-only">
        <h3>ğŸ“ Audit Notes</h3>
        <p id="modal-audit"></p>
      </section>

      <!-- Paperclip Tags -->
      <section class="module tags free-only">
        <h3>ğŸ“ Paperclip Tags</h3>
        <p id="modal-tags"></p>
      </section>
    </div>
  </div>
</div>
</body>
</html>